<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>온라인 출입 시스템</title>
<link rel="stylesheet" href="style.css">

<!-- QRCode.js 정식 원본 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
<div>
  <h1>휴 일 출 입 증<br>GIẤY XÁC NHẬN VÀO TRƯỜNG</h1>

  <label>학번(Mã số lớp)</label>
  <input type="text" id="studentId" placeholder="학번 입력">

  <label>이름(Họ tên)</label>
  <select id="studentName">
    <option value="">선택</option>
    <option value="이성현">이성현</option>
    <option value="김예건">김예건</option>
    <option value="양지웅">양지웅</option>
    <option value="양찬희">양찬희</option>
  </select>

  <label>사유(Lý do)</label>
  <select id="reason">
    <option value="">선택</option>
    <option value="수학퍼실리테이터">수학퍼실리테이터</option>
    <option value="방과후 수업">방과후 수업</option>
  </select>

  <label>지도교사(GV chủ nhiệm)</label>
  <select id="teacher">
    <option value="">선택</option>
    <option value="박선영">박선영</option>
    <option value="김철수">김철수</option>
  </select>

  <button id="applyBtn">QR 생성</button>

  <div id="qrBox" style="display:none;">
    <p>QR을 스캔하면 출입증이 표시됩니다.</p>
    <div id="qrImg"></div>
  </div>

  <footer class="footer">© 2025 Online Entry. All rights reserved.</footer>
</div>

<script>
document.getElementById("applyBtn").addEventListener("click", () => {
  const id = studentId.value;
  const name = studentName.value;
  const reasonV = reason.value;
  const teacherV = teacher.value;

  if (!id || !name) return alert("학번과 이름은 필수입니다.");

  const entry = "허가됨(Đã được chấp nhận)";
  const use = "사용 안함(Chưa sử dụng)";
  const today = new Date().toISOString().split("T")[0];

  const url =
    `entry.html?id=${encodeURIComponent(id)}&name=${encodeURIComponent(name)}&reason=${encodeURIComponent(reasonV)}&teacher=${encodeURIComponent(teacherV)}&entry=${encodeURIComponent(entry)}&use=${encodeURIComponent(use)}&date=${encodeURIComponent(today)}`;

  qrBox.style.display = "block";
  qrImg.innerHTML = "";

  new QRCode(qrImg, {
    text: url,
    width: 256,
    height: 256,
    colorDark: "#810707",
    colorLight: "#ffffff",
    correctLevel: QRCode.CorrectLevel.H
  });
});
</script>

</body>
</html>
